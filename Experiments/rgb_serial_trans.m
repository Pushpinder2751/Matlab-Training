s=serial('COM1');
set(s,'InputBufferSize',100000);
set(s,'OutputBufferSize',100000);
set(s,'BaudRate',9600,'DataBits',8,'Parity','none','StopBits',1,'FlowControl','none','TimeOut',40);
fopen(s);
i=imread('C:\fruit.jpg');
i_r=i(1:100,1:100,1);
i_g=i(1:100,1:100,2);
i_b=i(1:100,1:100,3);
i_r1=reshape(i_r,1,10000);
i_g1=reshape(i_g,1,10000);
i_b1=reshape(i_b,1,10000);
fwrite(s,i_r1);
pause(.1)
fwrite(s,i_g1);
pause(.1)
fwrite(s,i_b1);
pause(.1)